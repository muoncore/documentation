<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Using Events in Microservices</title>
  <meta name="description" content="">

    <link rel="stylesheet" href="/css/foundation.css">

    <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/css/fontello.css">
  <link rel="stylesheet" href="/css/font-awesome.css">
  <script src="/javascripts/modernizr.foundation.js" type="text/javascript"></script>
    <script src="/javascripts/jquery-2.1.0.js" type="text/javascript"></script>
    <script src="/javascripts/terrific-1.1.1.js" type="text/javascript"></script>
    <script src="/javascripts/jquery.url.js" type="text/javascript"></script>
    <script src="/javascripts/jquery.cookie.js" type="text/javascript"></script>
    <script src="/javascripts/json2.js" type="text/javascript"></script>
    <script src="/javascripts/foundation.js" type="text/javascript"></script>
  <script>
    // terrificjs bootstrap
    (function($) {
        $(document).ready(function() {
            var $page = $('body');
            var config = {
              dependencyPath: {
                plugin: 'javascripts/'
              }
            }
            var application = new Tc.Application($page, config);
            application.registerModules();
            application.start();
        });
    })(Tc.$);
  </script>
  <link href="http://fonts.googleapis.com/css?family=Raleway:400,700,300" media="screen" rel="stylesheet" type="text/css" />
  <script src="/javascripts/masonry.pkgd.js" type="text/javascript"></script>
  <script src="/javascripts/imagesloaded.pkgd.min.js" type="text/javascript"></script>
  <script src="/javascripts/slick.min.js" type="text/javascript"></script>

  <link rel="canonical" href="/guide/eventguide/java.html">
  <link rel="alternate" type="application/rss+xml" title="Muon - Microservice UX" href="/feed.xml" />
  <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
          <link rel="stylesheet" href="/css/asciidoc.css">
                  <style>
  @media only screen and (min-width:768px){#toctitle{font-size:1.375em}
      body.toc2{padding-left:15em;padding-right:0}
#toc {margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;right:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc >ul{font-size:.9em;margin-bottom:0}
#toc ul ul{margin-left:0;padding-left:1em}
#toc ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
  @media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc {width:20em}
#toc #toctitle{font-size:1.375em}
#toc >ul{font-size:.95em}
#toc ul ul{padding-left:1.25em}
      body.toc2.toc-right{padding-left:0;padding-right:20em}}

#toc { z-index:20; padding-top:120px;}
#documentation { padding-left:10px; margin-left:auto; margin-right:auto}
#documentation .row { margin:auto }
      code {
          background:none;
          border:0;
          display:block;
          width:100%;
      }

      code span { border: 0; width:100% }
      .listingblock {
         background: #eee;
         border-radius:5px;
          border:1px solid #ccc
      }
  }

  </style>
</head>


  <body>
    
      <a id='top'></a>
<div class='contain-to-grid sticky fullwidth'>
  <nav class='top-bar onepage' data-options='sticky_on: large' data-topbar=''>
    <ul class='title-area'>
      <li class='name'>
        <h1>
          <a href="/">
            <img alt="" src="/images/muonfulllogo-sm.jpg" />
          </a>
        </h1>
      </li>
      <li class='toggle-topbar menu-icon'>
        <a href='#'>Menu</a>
      </li>
    </ul>
    <section class='top-bar-section'>
      <ul class='right'>
        
          
            <li>
              
                <a href="/#top">Home</a>
              

            </li>
          
        
          
            <li>
              
                <a href="/#whymuon">Why Muon</a>
              

            </li>
          
        
          
            <li>
              
                <a href="/#ecosystem">Ecosystem</a>
              

            </li>
          
        
          
            <li>
              
                <a href="/#gettingstarted">Getting Started</a>
              

            </li>
          
        
          
            <li class="has-dropdown">
              <a href="/languages.html">Muon Documentation</a>
              <ul class='dropdown'>
                
                  <li>
                    <a href="/guide/index.html">MicroserviceUX Guides</a>
                  </li>
                
                  <li>
                    <a href="/java/SNAPSHOT/">Muon - Java</a>
                  </li>
                
                  <li>
                    <a href="/clojure/SNAPSHOT">Muon - Clojure</a>
                  </li>
                
                  <li>
                    <a href="/node/latest">Muon - Node.JS</a>
                  </li>
                
                  <li>
                    <a href="/node/latest">Muon - JavaScript/ Browser</a>
                  </li>
                
                  <li>
                    <a href="/implementmuon/index.html">&#x2B; your Language</a>
                  </li>
                
              </ul>
            </li>
          
        
          
            <li>
              
                <a href="/https://github.com/microserviceux">Github</a>
              

            </li>
          
        
      </ul>
    </section>
  </nav>
</div>
    

    <div id='main' role='main'>
      <div class="documentation">
<div class='full' style='background: #000'>
  <div class='row' style="margin-left:auto; margin-right:auto; max-width:90rem">
    <div class='large-12 columns'>
      <div class='mod modBlogPost big'>
        <div class='images'>
          
        </div>
        <div class='content' style="font-size:1.2rem">
          <h3><a href="/guide/eventguide/java.html">Using Events in Microservices</a></h3>

          <div id="toc" class="toc">
<div id="toctitle">Event Microservices</div>
<ul class="sectlevel1">
<li><a href="#setup">Setup</a></li>
<li><a href="#understanding-events">Understanding Events</a></li>
<li><a href="#design-your-events">Design Your Events</a></li>
<li><a href="#emitting-an-event">Emitting an Event</a></li>
<li><a href="#subscribing-and-acting-on-events">Subscribing and acting on Events</a></li>
<li><a href="#replaying-an-event-stream">Replaying an Event Stream</a></li>
<li><a href="#building-an-event-sourced-aggregation-from-an-event-stream">Building an Event Sourced Aggregation from an Event Stream</a></li>
<li><a href="#using-an-event-projection-in-place-of-an-aggregation">Using an Event Projection in place of an Aggregation</a></li>
</ul>
</div>
<div class="paragraph">
<p>Learning how to use event data in Muon.</p>
</div>
<div class="sect1">
<h2 id="setup">Setup</h2>
<div class="sectionbody">
<div class="paragraph">
<p>MicroserviceUX provides specific facilities for managing event based, stream oriented data. As in all things, this is available
as a set of distinct microservices. When running, they provide a data platform for building event based systems.</p>
</div>
<div class="paragraph">
<p>TODO - MENTION PHOTON, OTHERS?</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="understanding-events">Understanding Events</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Understanding your data, how it moves, what it means, is one of the most useful and powerful things that you as a software developer
can do. Too often the pressure is on to understand your data in terms of how it should be <em>presented</em>. By it&#8217;s very nature this means
that you take a snapshot in time of your data, and fold it into the shap you want. Often, you will do this ahead of time in the form
of a normalised database schema.</p>
</div>
<div class="paragraph">
<p>Imagine if you didn&#8217;t do this. Imagine instead that you looked on your data as it changes, on what <em>happens</em> to make it.</p>
</div>
<div class="paragraph">
<p>This is the nature of event based systems, they are described in terms of <em>what happens</em> rather than what questions you want to answer later on.</p>
</div>
<div class="paragraph">
<p>THe MicroserviceUX toolkit has this baked in deeply, and via the Photon project and event client libraries, can give you a rich, simple event
model that focuses on <strong>events</strong>, <strong>streams</strong> and queries across projections that we refer to as <strong>projections</strong>.</p>
</div>
<div class="paragraph">
<p>The Microservice architecture is intented to enable change, primarily by generating isolation between services, often using a network,
sometimes using some other common interface.</p>
</div>
<div class="paragraph">
<p>Adding events into the mix, specifically event sourcing, allows decoupling in time. Many times your services are truly connected in time
(<em>what is the current basket state</em>), however many things truly aren&#8217;t connected in time (<em>eg, send an email</em>).</p>
</div>
<div class="paragraph">
<p>Event architectures give you this option.</p>
</div>
<div class="paragraph">
<p>The rest of this guide will show you how to build an event based system using MicroserviceUX technologies.</p>
</div>
<div class="paragraph">
<p>We will be implementing a user registration system.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="design-your-events">Design Your Events</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When building an event based system, the first thing you need to figure out is <em>what should happen</em>. These actions, happenings,
are your events. Next, you can figure out how to convert the data in your events into something you can query.</p>
</div>
<div class="paragraph">
<p>For our user registration system, the following things will happen :-</p>
</div>
<div class="ulist">
<ul>
<li>
<p>User registers</p>
</li>
<li>
<p>User updates their record</p>
</li>
<li>
<p>User removes their record</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>We will want to show a list of the current users, and to be able to see the full, current, state of a particular user.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="emitting-an-event">Emitting an Event</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To get started, we need to be able to emit an event.</p>
</div>
<div class="paragraph">
<p>Using Muon, this is easy, you obtain the <em>Event Client</em>, and then call emit.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span style="color: #008000; font-weight: bold">package</span> io<span style="color: #666666">.</span><span style="color: #7D9029">muoncore</span><span style="color: #666666">.</span><span style="color: #7D9029">example</span><span style="color: #666666">;</span>

<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">io.muoncore.Muon</span><span style="color: #666666">;</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">io.muoncore.protocol.requestresponse.Response</span><span style="color: #666666">;</span>

<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">java.util.concurrent.ExecutionException</span><span style="color: #666666">;</span>

<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">static</span> io<span style="color: #666666">.</span><span style="color: #7D9029">muoncore</span><span style="color: #666666">.</span><span style="color: #7D9029">protocol</span><span style="color: #666666">.</span><span style="color: #7D9029">requestresponse</span><span style="color: #666666">.</span><span style="color: #7D9029">server</span><span style="color: #666666">.</span><span style="color: #7D9029">HandlerPredicates</span><span style="color: #666666">.</span><span style="color: #7D9029">all</span><span style="color: #666666">;</span>

<span style="color: #008000; font-weight: bold">public</span> <span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">ReactiveRPC</span> <span style="color: #666666">{</span>

    <span style="color: #008000; font-weight: bold">public</span> <span style="color: #B00040">void</span> <span style="color: #0000FF">exec</span><span style="color: #666666">(</span>Muon muon<span style="color: #666666">)</span> <span style="color: #008000; font-weight: bold">throws</span> ExecutionException<span style="color: #666666">,</span> InterruptedException <span style="color: #666666">{</span>

        <span style="color: #408080; font-style: italic">//request handler</span>
        muon<span style="color: #666666">.</span><span style="color: #7D9029">handleRequest</span><span style="color: #666666">(</span>all<span style="color: #666666">(),</span> Object<span style="color: #666666">.</span><span style="color: #7D9029">class</span><span style="color: #666666">,</span> request <span style="color: #666666">-&gt;</span> <span style="color: #666666">{</span>
            request<span style="color: #666666">.</span><span style="color: #7D9029">ok</span><span style="color: #666666">(</span><span style="color: #BA2121">&quot;Hi There&quot;</span><span style="color: #666666">);</span>
        <span style="color: #666666">});</span>

        <span style="color: #408080; font-style: italic">//request client</span>
        Response<span style="color: #666666">&lt;</span>String<span style="color: #666666">&gt;</span> data <span style="color: #666666">=</span> muon<span style="color: #666666">.</span><span style="color: #7D9029">request</span><span style="color: #666666">(</span><span style="color: #BA2121">&quot;request://myservice/&quot;</span><span style="color: #666666">,</span> String<span style="color: #666666">.</span><span style="color: #7D9029">class</span><span style="color: #666666">).</span><span style="color: #7D9029">get</span><span style="color: #666666">();</span>

        System<span style="color: #666666">.</span><span style="color: #7D9029">out</span><span style="color: #666666">.</span><span style="color: #7D9029">println</span><span style="color: #666666">(</span><span style="color: #BA2121">&quot;The Data is &quot;</span> <span style="color: #666666">+</span> data<span style="color: #666666">.</span><span style="color: #7D9029">getPayload</span><span style="color: #666666">());</span>
    <span style="color: #666666">}</span>
<span style="color: #666666">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This is all!  Your event is now persisted, and available for replay or analysis.</p>
</div>
<div class="paragraph">
<p>It is possible to react to events as they are emitted by <em>subscribing</em> to the appropriate event stream.
Your code will then receive a push notification whenever an event is emitted.</p>
</div>
<div class="paragraph">
<p>You can also, after the fact, replay all of the events and do some analysis. You may also combine these, replay the historical events
and then once they have been consumed, continue to process new events, live, as they are emitted.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="subscribing-and-acting-on-events">Subscribing and acting on Events</h2>
<div class="sectionbody">
<div class="paragraph">
<p>All events in MicroserviceUX are arranged into <em>streams</em>. These are ordered, serial lists of events, stored in the order
that they were persisted in.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Try doing this part in another language to your emitting code and see how they work together.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Your microservices can subscribe to a stream to be notified whenever a new event occurs, so they can react to it, use it, or discard it.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span style="color: #008000; font-weight: bold">package</span> io<span style="color: #666666">.</span><span style="color: #7D9029">muoncore</span><span style="color: #666666">.</span><span style="color: #7D9029">example</span><span style="color: #666666">;</span>

<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">io.muoncore.Muon</span><span style="color: #666666">;</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">io.muoncore.protocol.requestresponse.Response</span><span style="color: #666666">;</span>

<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">java.util.concurrent.ExecutionException</span><span style="color: #666666">;</span>

<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">static</span> io<span style="color: #666666">.</span><span style="color: #7D9029">muoncore</span><span style="color: #666666">.</span><span style="color: #7D9029">protocol</span><span style="color: #666666">.</span><span style="color: #7D9029">requestresponse</span><span style="color: #666666">.</span><span style="color: #7D9029">server</span><span style="color: #666666">.</span><span style="color: #7D9029">HandlerPredicates</span><span style="color: #666666">.</span><span style="color: #7D9029">all</span><span style="color: #666666">;</span>

<span style="color: #008000; font-weight: bold">public</span> <span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">ReactiveRPC</span> <span style="color: #666666">{</span>

    <span style="color: #008000; font-weight: bold">public</span> <span style="color: #B00040">void</span> <span style="color: #0000FF">exec</span><span style="color: #666666">(</span>Muon muon<span style="color: #666666">)</span> <span style="color: #008000; font-weight: bold">throws</span> ExecutionException<span style="color: #666666">,</span> InterruptedException <span style="color: #666666">{</span>

        <span style="color: #408080; font-style: italic">//request handler</span>
        muon<span style="color: #666666">.</span><span style="color: #7D9029">handleRequest</span><span style="color: #666666">(</span>all<span style="color: #666666">(),</span> Object<span style="color: #666666">.</span><span style="color: #7D9029">class</span><span style="color: #666666">,</span> request <span style="color: #666666">-&gt;</span> <span style="color: #666666">{</span>
            request<span style="color: #666666">.</span><span style="color: #7D9029">ok</span><span style="color: #666666">(</span><span style="color: #BA2121">&quot;Hi There&quot;</span><span style="color: #666666">);</span>
        <span style="color: #666666">});</span>

        <span style="color: #408080; font-style: italic">//request client</span>
        Response<span style="color: #666666">&lt;</span>String<span style="color: #666666">&gt;</span> data <span style="color: #666666">=</span> muon<span style="color: #666666">.</span><span style="color: #7D9029">request</span><span style="color: #666666">(</span><span style="color: #BA2121">&quot;request://myservice/&quot;</span><span style="color: #666666">,</span> String<span style="color: #666666">.</span><span style="color: #7D9029">class</span><span style="color: #666666">).</span><span style="color: #7D9029">get</span><span style="color: #666666">();</span>

        System<span style="color: #666666">.</span><span style="color: #7D9029">out</span><span style="color: #666666">.</span><span style="color: #7D9029">println</span><span style="color: #666666">(</span><span style="color: #BA2121">&quot;The Data is &quot;</span> <span style="color: #666666">+</span> data<span style="color: #666666">.</span><span style="color: #7D9029">getPayload</span><span style="color: #666666">());</span>
    <span style="color: #666666">}</span>
<span style="color: #666666">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="replaying-an-event-stream">Replaying an Event Stream</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span style="color: #008000; font-weight: bold">package</span> io<span style="color: #666666">.</span><span style="color: #7D9029">muoncore</span><span style="color: #666666">.</span><span style="color: #7D9029">example</span><span style="color: #666666">;</span>

<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">io.muoncore.Muon</span><span style="color: #666666">;</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">io.muoncore.protocol.requestresponse.Response</span><span style="color: #666666">;</span>

<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">java.util.concurrent.ExecutionException</span><span style="color: #666666">;</span>

<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">static</span> io<span style="color: #666666">.</span><span style="color: #7D9029">muoncore</span><span style="color: #666666">.</span><span style="color: #7D9029">protocol</span><span style="color: #666666">.</span><span style="color: #7D9029">requestresponse</span><span style="color: #666666">.</span><span style="color: #7D9029">server</span><span style="color: #666666">.</span><span style="color: #7D9029">HandlerPredicates</span><span style="color: #666666">.</span><span style="color: #7D9029">all</span><span style="color: #666666">;</span>

<span style="color: #008000; font-weight: bold">public</span> <span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">ReactiveRPC</span> <span style="color: #666666">{</span>

    <span style="color: #008000; font-weight: bold">public</span> <span style="color: #B00040">void</span> <span style="color: #0000FF">exec</span><span style="color: #666666">(</span>Muon muon<span style="color: #666666">)</span> <span style="color: #008000; font-weight: bold">throws</span> ExecutionException<span style="color: #666666">,</span> InterruptedException <span style="color: #666666">{</span>

        <span style="color: #408080; font-style: italic">//request handler</span>
        muon<span style="color: #666666">.</span><span style="color: #7D9029">handleRequest</span><span style="color: #666666">(</span>all<span style="color: #666666">(),</span> Object<span style="color: #666666">.</span><span style="color: #7D9029">class</span><span style="color: #666666">,</span> request <span style="color: #666666">-&gt;</span> <span style="color: #666666">{</span>
            request<span style="color: #666666">.</span><span style="color: #7D9029">ok</span><span style="color: #666666">(</span><span style="color: #BA2121">&quot;Hi There&quot;</span><span style="color: #666666">);</span>
        <span style="color: #666666">});</span>

        <span style="color: #408080; font-style: italic">//request client</span>
        Response<span style="color: #666666">&lt;</span>String<span style="color: #666666">&gt;</span> data <span style="color: #666666">=</span> muon<span style="color: #666666">.</span><span style="color: #7D9029">request</span><span style="color: #666666">(</span><span style="color: #BA2121">&quot;request://myservice/&quot;</span><span style="color: #666666">,</span> String<span style="color: #666666">.</span><span style="color: #7D9029">class</span><span style="color: #666666">).</span><span style="color: #7D9029">get</span><span style="color: #666666">();</span>

        System<span style="color: #666666">.</span><span style="color: #7D9029">out</span><span style="color: #666666">.</span><span style="color: #7D9029">println</span><span style="color: #666666">(</span><span style="color: #BA2121">&quot;The Data is &quot;</span> <span style="color: #666666">+</span> data<span style="color: #666666">.</span><span style="color: #7D9029">getPayload</span><span style="color: #666666">());</span>
    <span style="color: #666666">}</span>
<span style="color: #666666">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="building-an-event-sourced-aggregation-from-an-event-stream">Building an Event Sourced Aggregation from an Event Stream</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span style="color: #008000; font-weight: bold">package</span> io<span style="color: #666666">.</span><span style="color: #7D9029">muoncore</span><span style="color: #666666">.</span><span style="color: #7D9029">example</span><span style="color: #666666">;</span>

<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">io.muoncore.Muon</span><span style="color: #666666">;</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">io.muoncore.protocol.requestresponse.Response</span><span style="color: #666666">;</span>

<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">java.util.concurrent.ExecutionException</span><span style="color: #666666">;</span>

<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">static</span> io<span style="color: #666666">.</span><span style="color: #7D9029">muoncore</span><span style="color: #666666">.</span><span style="color: #7D9029">protocol</span><span style="color: #666666">.</span><span style="color: #7D9029">requestresponse</span><span style="color: #666666">.</span><span style="color: #7D9029">server</span><span style="color: #666666">.</span><span style="color: #7D9029">HandlerPredicates</span><span style="color: #666666">.</span><span style="color: #7D9029">all</span><span style="color: #666666">;</span>

<span style="color: #008000; font-weight: bold">public</span> <span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">ReactiveRPC</span> <span style="color: #666666">{</span>

    <span style="color: #008000; font-weight: bold">public</span> <span style="color: #B00040">void</span> <span style="color: #0000FF">exec</span><span style="color: #666666">(</span>Muon muon<span style="color: #666666">)</span> <span style="color: #008000; font-weight: bold">throws</span> ExecutionException<span style="color: #666666">,</span> InterruptedException <span style="color: #666666">{</span>

        <span style="color: #408080; font-style: italic">//request handler</span>
        muon<span style="color: #666666">.</span><span style="color: #7D9029">handleRequest</span><span style="color: #666666">(</span>all<span style="color: #666666">(),</span> Object<span style="color: #666666">.</span><span style="color: #7D9029">class</span><span style="color: #666666">,</span> request <span style="color: #666666">-&gt;</span> <span style="color: #666666">{</span>
            request<span style="color: #666666">.</span><span style="color: #7D9029">ok</span><span style="color: #666666">(</span><span style="color: #BA2121">&quot;Hi There&quot;</span><span style="color: #666666">);</span>
        <span style="color: #666666">});</span>

        <span style="color: #408080; font-style: italic">//request client</span>
        Response<span style="color: #666666">&lt;</span>String<span style="color: #666666">&gt;</span> data <span style="color: #666666">=</span> muon<span style="color: #666666">.</span><span style="color: #7D9029">request</span><span style="color: #666666">(</span><span style="color: #BA2121">&quot;request://myservice/&quot;</span><span style="color: #666666">,</span> String<span style="color: #666666">.</span><span style="color: #7D9029">class</span><span style="color: #666666">).</span><span style="color: #7D9029">get</span><span style="color: #666666">();</span>

        System<span style="color: #666666">.</span><span style="color: #7D9029">out</span><span style="color: #666666">.</span><span style="color: #7D9029">println</span><span style="color: #666666">(</span><span style="color: #BA2121">&quot;The Data is &quot;</span> <span style="color: #666666">+</span> data<span style="color: #666666">.</span><span style="color: #7D9029">getPayload</span><span style="color: #666666">());</span>
    <span style="color: #666666">}</span>
<span style="color: #666666">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="using-an-event-projection-in-place-of-an-aggregation">Using an Event Projection in place of an Aggregation</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span style="color: #008000; font-weight: bold">package</span> io<span style="color: #666666">.</span><span style="color: #7D9029">muoncore</span><span style="color: #666666">.</span><span style="color: #7D9029">example</span><span style="color: #666666">;</span>

<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">io.muoncore.Muon</span><span style="color: #666666">;</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">io.muoncore.protocol.requestresponse.Response</span><span style="color: #666666">;</span>

<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">java.util.concurrent.ExecutionException</span><span style="color: #666666">;</span>

<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">static</span> io<span style="color: #666666">.</span><span style="color: #7D9029">muoncore</span><span style="color: #666666">.</span><span style="color: #7D9029">protocol</span><span style="color: #666666">.</span><span style="color: #7D9029">requestresponse</span><span style="color: #666666">.</span><span style="color: #7D9029">server</span><span style="color: #666666">.</span><span style="color: #7D9029">HandlerPredicates</span><span style="color: #666666">.</span><span style="color: #7D9029">all</span><span style="color: #666666">;</span>

<span style="color: #008000; font-weight: bold">public</span> <span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">ReactiveRPC</span> <span style="color: #666666">{</span>

    <span style="color: #008000; font-weight: bold">public</span> <span style="color: #B00040">void</span> <span style="color: #0000FF">exec</span><span style="color: #666666">(</span>Muon muon<span style="color: #666666">)</span> <span style="color: #008000; font-weight: bold">throws</span> ExecutionException<span style="color: #666666">,</span> InterruptedException <span style="color: #666666">{</span>

        <span style="color: #408080; font-style: italic">//request handler</span>
        muon<span style="color: #666666">.</span><span style="color: #7D9029">handleRequest</span><span style="color: #666666">(</span>all<span style="color: #666666">(),</span> Object<span style="color: #666666">.</span><span style="color: #7D9029">class</span><span style="color: #666666">,</span> request <span style="color: #666666">-&gt;</span> <span style="color: #666666">{</span>
            request<span style="color: #666666">.</span><span style="color: #7D9029">ok</span><span style="color: #666666">(</span><span style="color: #BA2121">&quot;Hi There&quot;</span><span style="color: #666666">);</span>
        <span style="color: #666666">});</span>

        <span style="color: #408080; font-style: italic">//request client</span>
        Response<span style="color: #666666">&lt;</span>String<span style="color: #666666">&gt;</span> data <span style="color: #666666">=</span> muon<span style="color: #666666">.</span><span style="color: #7D9029">request</span><span style="color: #666666">(</span><span style="color: #BA2121">&quot;request://myservice/&quot;</span><span style="color: #666666">,</span> String<span style="color: #666666">.</span><span style="color: #7D9029">class</span><span style="color: #666666">).</span><span style="color: #7D9029">get</span><span style="color: #666666">();</span>

        System<span style="color: #666666">.</span><span style="color: #7D9029">out</span><span style="color: #666666">.</span><span style="color: #7D9029">println</span><span style="color: #666666">(</span><span style="color: #BA2121">&quot;The Data is &quot;</span> <span style="color: #666666">+</span> data<span style="color: #666666">.</span><span style="color: #7D9029">getPayload</span><span style="color: #666666">());</span>
    <span style="color: #666666">}</span>
<span style="color: #666666">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span style="color: #008000; font-weight: bold">package</span> io<span style="color: #666666">.</span><span style="color: #7D9029">muoncore</span><span style="color: #666666">.</span><span style="color: #7D9029">example</span><span style="color: #666666">;</span>

<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">io.muoncore.Muon</span><span style="color: #666666">;</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">io.muoncore.protocol.requestresponse.Response</span><span style="color: #666666">;</span>

<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">java.util.concurrent.ExecutionException</span><span style="color: #666666">;</span>

<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">static</span> io<span style="color: #666666">.</span><span style="color: #7D9029">muoncore</span><span style="color: #666666">.</span><span style="color: #7D9029">protocol</span><span style="color: #666666">.</span><span style="color: #7D9029">requestresponse</span><span style="color: #666666">.</span><span style="color: #7D9029">server</span><span style="color: #666666">.</span><span style="color: #7D9029">HandlerPredicates</span><span style="color: #666666">.</span><span style="color: #7D9029">all</span><span style="color: #666666">;</span>

<span style="color: #008000; font-weight: bold">public</span> <span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">ReactiveRPC</span> <span style="color: #666666">{</span>

    <span style="color: #008000; font-weight: bold">public</span> <span style="color: #B00040">void</span> <span style="color: #0000FF">exec</span><span style="color: #666666">(</span>Muon muon<span style="color: #666666">)</span> <span style="color: #008000; font-weight: bold">throws</span> ExecutionException<span style="color: #666666">,</span> InterruptedException <span style="color: #666666">{</span>

        <span style="color: #408080; font-style: italic">//request handler</span>
        muon<span style="color: #666666">.</span><span style="color: #7D9029">handleRequest</span><span style="color: #666666">(</span>all<span style="color: #666666">(),</span> Object<span style="color: #666666">.</span><span style="color: #7D9029">class</span><span style="color: #666666">,</span> request <span style="color: #666666">-&gt;</span> <span style="color: #666666">{</span>
            request<span style="color: #666666">.</span><span style="color: #7D9029">ok</span><span style="color: #666666">(</span><span style="color: #BA2121">&quot;Hi There&quot;</span><span style="color: #666666">);</span>
        <span style="color: #666666">});</span>

        <span style="color: #408080; font-style: italic">//request client</span>
        Response<span style="color: #666666">&lt;</span>String<span style="color: #666666">&gt;</span> data <span style="color: #666666">=</span> muon<span style="color: #666666">.</span><span style="color: #7D9029">request</span><span style="color: #666666">(</span><span style="color: #BA2121">&quot;request://myservice/&quot;</span><span style="color: #666666">,</span> String<span style="color: #666666">.</span><span style="color: #7D9029">class</span><span style="color: #666666">).</span><span style="color: #7D9029">get</span><span style="color: #666666">();</span>

        System<span style="color: #666666">.</span><span style="color: #7D9029">out</span><span style="color: #666666">.</span><span style="color: #7D9029">println</span><span style="color: #666666">(</span><span style="color: #BA2121">&quot;The Data is &quot;</span> <span style="color: #666666">+</span> data<span style="color: #666666">.</span><span style="color: #7D9029">getPayload</span><span style="color: #666666">());</span>
    <span style="color: #666666">}</span>
<span style="color: #666666">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span style="color: #008000; font-weight: bold">package</span> io<span style="color: #666666">.</span><span style="color: #7D9029">muoncore</span><span style="color: #666666">.</span><span style="color: #7D9029">example</span><span style="color: #666666">;</span>

<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">io.muoncore.Muon</span><span style="color: #666666">;</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">io.muoncore.protocol.requestresponse.Response</span><span style="color: #666666">;</span>

<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">java.util.concurrent.ExecutionException</span><span style="color: #666666">;</span>

<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">static</span> io<span style="color: #666666">.</span><span style="color: #7D9029">muoncore</span><span style="color: #666666">.</span><span style="color: #7D9029">protocol</span><span style="color: #666666">.</span><span style="color: #7D9029">requestresponse</span><span style="color: #666666">.</span><span style="color: #7D9029">server</span><span style="color: #666666">.</span><span style="color: #7D9029">HandlerPredicates</span><span style="color: #666666">.</span><span style="color: #7D9029">all</span><span style="color: #666666">;</span>

<span style="color: #008000; font-weight: bold">public</span> <span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">ReactiveRPC</span> <span style="color: #666666">{</span>

    <span style="color: #008000; font-weight: bold">public</span> <span style="color: #B00040">void</span> <span style="color: #0000FF">exec</span><span style="color: #666666">(</span>Muon muon<span style="color: #666666">)</span> <span style="color: #008000; font-weight: bold">throws</span> ExecutionException<span style="color: #666666">,</span> InterruptedException <span style="color: #666666">{</span>

        <span style="color: #408080; font-style: italic">//request handler</span>
        muon<span style="color: #666666">.</span><span style="color: #7D9029">handleRequest</span><span style="color: #666666">(</span>all<span style="color: #666666">(),</span> Object<span style="color: #666666">.</span><span style="color: #7D9029">class</span><span style="color: #666666">,</span> request <span style="color: #666666">-&gt;</span> <span style="color: #666666">{</span>
            request<span style="color: #666666">.</span><span style="color: #7D9029">ok</span><span style="color: #666666">(</span><span style="color: #BA2121">&quot;Hi There&quot;</span><span style="color: #666666">);</span>
        <span style="color: #666666">});</span>

        <span style="color: #408080; font-style: italic">//request client</span>
        Response<span style="color: #666666">&lt;</span>String<span style="color: #666666">&gt;</span> data <span style="color: #666666">=</span> muon<span style="color: #666666">.</span><span style="color: #7D9029">request</span><span style="color: #666666">(</span><span style="color: #BA2121">&quot;request://myservice/&quot;</span><span style="color: #666666">,</span> String<span style="color: #666666">.</span><span style="color: #7D9029">class</span><span style="color: #666666">).</span><span style="color: #7D9029">get</span><span style="color: #666666">();</span>

        System<span style="color: #666666">.</span><span style="color: #7D9029">out</span><span style="color: #666666">.</span><span style="color: #7D9029">println</span><span style="color: #666666">(</span><span style="color: #BA2121">&quot;The Data is &quot;</span> <span style="color: #666666">+</span> data<span style="color: #666666">.</span><span style="color: #7D9029">getPayload</span><span style="color: #666666">());</span>
    <span style="color: #666666">}</span>
<span style="color: #666666">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Building an aggregation is a useful technique, and will give you a data structure in locall memory that you can</p>
</div>
</div>
</div>
        </div>
      </div>

      <div class='four spacing'></div>
    </div>
  </div>
</div>
</div>
    </div>

    <div class='full no-padding' style='background: #111'>
  <div class='two spacing'></div>
  <div class='row'>
    <div class='large-12 columns' style="color:white;">
      <p>©2016 Muon Core Ltd. All rights reserved.</p>
    </div>
  </div>
  <div class='spacing'></div>
</div>


<script src="/javascripts/jquery.countTo.js" type="text/javascript"></script>
<script src="/javascripts/jquery.appear.js" type="text/javascript"></script>
<script src="/javascripts/jquery.validate.js" type="text/javascript"></script>
<script src="/javascripts/jquery.sequence-min.js" type="text/javascript"></script>
<script src="/javascripts/jquery.easing.1.3.js" type="text/javascript"></script>
<script src="/javascripts/app.js" type="text/javascript"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-75338923-1', 'auto');
  ga('require', 'linkid');
  ga('send', 'pageview');

</script>


  </body>

</html>
